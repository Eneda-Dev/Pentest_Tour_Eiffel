# Module Pentest - Rapport
### - Nicolas Taffoureau - Pacôme Tisserand - Eneda Devolli -

Nous allons étudier dans ce rapport la [société de la Tour Eiffel](http://www.societetoureiffel.com).

![Tour Eiffel](toureiffel.jpg)

# Contexte 

Cette recherche de renseignement d'origine source ouverte (ROSO, également appelé OSINT en anglais) nous a été demandé par le responsable du module Pentest de l'AFTI, M. David Deloenzien lors du premier cour de pentest.

L'obectif était de faire une recherche d'information utile à un attaquant dans une optique de pentest d'une entreprise comprise dans le marché de type B de la Bourse de Paris.

Nous avons choisit comme cible la société d'exploitation de la tour Effeil (SETE) sur la base de cette URL : https://www.abcbourse.com/analyses/chiffres.aspx?s=EIFFp

A l'issu de cette recherche, nous avons pu découvrir une partie de l'environnement utilisateur de l'entreprise, un certain nombre d'employés, un certain nombre de relations de cette entreprise avec d'autres et enfin, cela nous permet d'extrapoler sur les éléments sur lesquels cette entreprise serait la plus vulnérable. 

# Informations générales sur l'entreprise

La SETE est une société de gestion immobilière qui s'occupe de la tour Effeil, mais également d'un certain nombre de quartiers pavillonaires dans différentes régions de France qu'elle a financé sur capitaux propres ou emprunts.

Pour obtenir la plupart des informations d'assemblée général de l'entreprise, ainsi que ces comptes, nous avons employés une dork qui nous permettait de récupérer aisément l'ensemble des PDF accessibles sur son site. : 
`site:societetoureiffel.com filetype:pdf`

## Organigramme

En faisant des recherches sur Google, dans les articles de presse ainsi que sur LinkedIn, nous avons pu répartorier un
certains nombre d'employés de l'entreprise occupant des postes à responsabilités.

Fonction | Nom
------------ | -------------
Directeur Général | Thomas Georgeon
Directeur Général Délégué | Bruno Meyer
Directeur Immobilier | Nicolas Ingueneau
Secretaire Générale | Veronique Moëllo
Gestionnaire Administrative | Charlotte Dupin
Directeur des opérations immobilière | Julien Vernerey
Ancien Directeur Général (jusqu'au 28/09/2018) | Philippe Lemoine
Président du Conseil d'Administration | Hubert Rodarie
Chargée de mission auprès de la Direction Générale et RSE | Fabienne Renucci
Responsable technique | Georges Baptista
Contact presse | Jean Philippe Mocci
Contrôleur financier | Thomas de Paz
Coordination , Gestion & Planification de Projet | Marcela Mantilla-Duran
Director Asset Management | Cindy Assencio-Drieu
Directrice Communication et Marketing | Mireille Rivier
Directrice de centre | Magali Cerdan
Directrice de la Gestion Immobilière | Odile Batsere
Chargée d’investissements | Delphine Payelleville
Asset Manager Senior | Elodie Babian
Responsable Communication | Stéphanie Philippe
Asset Manager | Vincent Leroy


## Patrimoine immobilier

# Informations sur le système de l'entreprise

## Domaines web

![Domaines](subdomaine.png)

On remarque que le site web de l'entreprise possède plusieurs sous domaines,
ce qui peut être intéressant à savoir pour de la prise d'empreintes par exemple.

## Adresses mails

En effectuant une série de Google Dorks, nous sommes arrivés à trouver une dizaine d'adresses
mails, qui peuvent être utilisées par une personne malveillante pour établir une liste de spam,
ou pour faire de l'ingéniérie sociale pour s'introduire sur le système intern.

`site:societetoureiffel.com filetype:pdf @stoureiffel.com`

```

actionnaires@stoureiffel.com
v.leroy@stoureiffel.com
contact@stoureiffel.com
s.gay-perret@stoureiffel.com
c.assencio-drieu@stoureiffel.com
b.meyer@stoureiffel
renaud.haberkorn@stoureiffel.com
p.detremiolles@stoureiffel.com
f.maman@stoureiffel
m.rivier@stoureiffel.com
r.haberkorn@stoureiffel.com

```

## Découverte de l'environnement IT de l'entreprise

En premier lieu, le site toureiffel.paris est protégé par le reverse proxy Cloudflare.
Ce qui signifie que nous n'avons pas forcément accès aux réelles IP du site mais aux IP proposés par cloudflare.
On s'en rend compte avec un dig m.toureiffel.pars qui retourne notamment "m.toureiffel.paris. 1792 IN CNAME www.toureiffel.paris.cdn.cloudflare.net".

C'est problématique pour la découverte du réseau car il n'est par exemple pas possible de découvrir les IP contingente au site, ses données WHOIS ou de faire de la découverte de service avec des outils comme Nmap.

Cependant, l'ensemble des sous-domaines listés précédemment permettent de trouver des éléments intéressants.

### Reconnaissance d'outils bureautiques

Tout d'abord sur autodiscover.toureiffel.paris, un dig donne des éléments d'utilisations
de la suite office et de outlook, ce qui permet de connaitre leur suite
bureautique.

![Autodiscover](https://raw.githubusercontent.com/ntaff/pentest_tour_eiffel/master/tour%20effeil%20bureautique.png)

Ici, la première ligne "autodiscover.outlook.com" indique l'utilisation probablement de outlook comme gestionnaire mail, quand au second terminant par "office.com", indique l'emploi de la suite office, de même pour le troisième.
Cette reconnaissance des outils employés par cette entreprise faciliterais ainsi une opération de phishing, ou bien la création d'une APT. Malheureusement, ces modifications sont obligatoires pour l'utilisation de la dernière génération de suite office et de outlook. Il n'y a donc pas encore de protection à ajouter sur cela.

### Détection d'un VPN d'entreprise

Ensuite, sur vpn.toureiffel.paris, on trouve l'ip `104.20.252.69` et un whois dessus donne la société Arkena SAS qui est un intégrateur. 
Logiquement, vu qu'ils possèdent un LIR, ils ont probablement mis en place un VPN privé dessus ou bien peut-être font-ils providers d'IP pour un besoin spécifique.
Cette ip donne sur son port 443 une page de login indiquant des probables groupes d'utilisateurs de la société toureffeil.  

![VPN](https://raw.githubusercontent.com/ntaff/pentest_tour_eiffel/master/capture%20vpn.png)

On peut noter sur cette image l'existence de groupe qui laissent supposer la configuration d'un LDAP.

### Détection d'un service inconnu

Concernant secform.toureiffel.paris, cela pointe vers `95.81.168.166` qui est encore une IP appartenant également à Arkena SAS. 
Cette fois-ci, on tombe en HTTPS sur un serveur Apache qui nous donne son numéro de version : `Apache/2.4.25 (Debian) Server at 95.81.168.166 Port 443`.


### Apparté sur les certificats des services Arkena

A noter que le certificat employé pour ces deux IP par Arkena est fournit par Gandi, ce qui signifie que Gandi est très probablement host des machines.
Si ils emploient de la mutualisation de ressource, il est possible d'attaquer les machines depuis une machine proche dans
l'environnement mutualisé.

### Services OVH mutualisés

les domaines sparkling.toureiffel.paris et scintillement.toureiffel.paris pointent vers une ip : `178.33.110.27`.
Cette IP n'appartient pas à Cloudflare mais à OVH, ce qui signifie qu'elle n'est pas une IP d'intermédiaire.
Si on va directement dessus, on devine qu'il s'agit d'un service mutualisé en raison du fait que l'ip ne redirige pas vers un domaine par défaut mais vers une page vide.
Enfin, si on cherche sur : https://ipinfo.io/178.33.110.27

On trouve 


    boutiquesdemusees.fr
    cite-palais.boutique
    mariepuce.eu
    farandoles.com
    boutiquedumuseeduluxembourg.com
    mariepuce.com
    palais-cite.boutique
    catalogue-publications-rmn.com
    catalogue-images-rmn.com

Ce qui laisse à penser que ce service est mutualisé par une entreprise de création de site web commerciaux.
Très probablement cette entreprise, qui reviens régulièrement dans les mentions légales : http://mamas.am/
C'est un vecteur d'attaque car si un seul des sites est faillible, il peut donner accès aux autres par effet de proximité.

Cependant, il n'est aucunement garantit que la prise de control de cette structure puisse donner plus de possibilités d'intrusion dans l'environnement IT de la société Tour Effeil du fait de sa séparation avec le site de base.

### Découverte non exploitable sur un dernier sous domaine

Enfin, concernant https://sete.toureiffel.paris/fr/presse, 
cela pointe vers `188.165.225.227`.

Et cette IP, appelé directement : https://188.165.225.227/
Donne accès à une interface Plesk qui indique donc la technologie  de gestion de hosting web employé.

Cela ne semble donner que peu d'information, excepté sur le mode de gestion de l'hébergement OVH proposé.

# Conclusion

Avec l'ensemble de ces éléments, nous avons que le coeur de métier de la SETE est l'exploitation immobilière, ce qui signifie que son environnement informatique n'est pas géré en interne. La gestion des différent sites web que la SETE possède a très probablement été sous-traités à différentes entreprises, dont Arkena SAS ainsi que la société MAMASAM.

Son environnement informatique donne des indications sur ce que les employés utilisent. Soit Outlook, Microsoft Office 365 ainsi qu'un VPN qu'il faut encore identifier.

Les attaques qui feraient sens dans cet environnement seraient proches du Social Engineering, soit du phishing ou une tentative d'intrusion par emploi d'un "Remote Access Tool" (RAT).
